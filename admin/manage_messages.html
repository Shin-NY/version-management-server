<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
    <title>Manage Messages - Admin Dashboard</title>
</head>
<body>

<header>
    <h1>Manage Messages - Admin Dashboard</h1>
</header>

<nav>
    <ul>
        <li><a href="index.html">Home</a></li>
        <li><a href="manage_messages.html">Manage Messages</a></li>
        <li><a href="manage_modules.html">Manage Modules</a></li>
        <li><a href="update_agent.html">Agent Updates</a></li>
    </ul>
</nav>

<main>
    <section>
        <h2>Manage Repeated Messages</h2>
        
        <!-- 메시지 입력 폼 -->
        <form id="messageForm">
            <label for="message">Enter a new message:</label><br>
            <textarea id="message" name="message" rows="4" cols="50" placeholder="Type your message here..."></textarea><br><br>
            <button type="button" onclick="saveMessage()">Save Message</button>
        </form>

        <hr>

        <!-- 서버에 저장된 메시지 목록 -->
        <h3>Saved Messages</h3>
        <ul id="messageList">
            <!-- 서버에서 불러온 메시지 목록이 여기에 표시됩니다 -->
        </ul>

    </section>
</main>

<footer>
    <p>Admin Dashboard © 2024</p>
</footer>

<script>
// 메시지를 저장하는 함수 (서버에 POST 요청을 보낸다고 가정)
function saveMessage() {
    const message = document.getElementById('message').value;
    if (message.trim() === '') {
        alert("Please enter a message before saving.");
        return;
    }

    // 예시: 서버에 메시지를 저장하는 POST 요청
    fetch('https://example.com/api/messages', { // 실제 서버 주소로 변경
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({ message }),
    })
    .then(response => response.json())
    .then(data => {
        alert('Message saved successfully!');
        document.getElementById('message').value = ''; // 입력란 초기화
        fetchMessages(); // 메시지 목록 갱신
    })
    .catch(error => {
        console.error('Error saving message:', error);
    });
}

// 서버에서 저장된 메시지 목록을 불러오는 함수 (GET 요청)
function fetchMessages() {
    fetch('https://example.com/api/messages') // 실제 서버 주소로 변경
        .then(response => response.json())
        .then(data => {
            const messageList = document.getElementById('messageList');
            messageList.innerHTML = ''; // 기존 메시지 목록을 초기화

            data.forEach(message => {
                const li = document.createElement('li');
                li.textContent = message.text; // 서버로부터 받은 메시지 내용
                messageList.appendChild(li);
            });
        })
        .catch(error => {
            console.error('Error fetching messages:', error);
        });
}

// 페이지가 로드되면 메시지 목록을 불러옴
window.onload = fetchMessages;
</script>

</body>
</html>
